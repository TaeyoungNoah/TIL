

# 동적메모리 할당

- 변수를 선언하는 대신 프로그램의 요청으로 메모리를 할당할 수 있다.

  이것을 **동적메모리 할당** (dynamic memory allocation) 이라고 부른다.

- malloc 함수를 호출하여 동적메모리 할당을 요청하면 요구하는 크기의 메모리를 할당하고

  그 **시작 주소를 반환**한다.



# malloc 함수



```c
int *p;
p = (int *)malloc(40);
if (p==NULL) {
  /* 동적 메모리 할당이 실패 */
  /* 적절한 조치를 취한다 */
}

p[0] = 12;
p[1] = 24;
*(p+2) = 36;
...
```

> - **(int *)malloc(40);**
>
> `(int *)` : 
> malloc이 반환하는 주소는 타입이 없는 주소(void *)이다.
> 정수들을 저장하기 위해서는 int * 로 변환한다. (반드시 필요한 것은 아님)
>
> 
>
> `(40)` : 
> 할당받을 메모리의 크기를 byte 단위로 지정한다. 
> 여기서는 10개의 정수를 저장하기 위해 40바이트를 요청했다.
>
> - **malloc 으로 할당받은 메모리는 보통의 배열처럼 사용한다**





# 배열 키우기

- 동적으로 할당된 배열은 공간이 부족할 경우 더 큰 배열을 할당하여 사용할 수 있다.

```c
int * array = (int *)malloc(4*sizeof(int));

/* 배열 array의 크기가 부족한 상황이 발생한다. */

int * tmp = (int *)malloc(8*sizeof(int));
int i;
for (i=0; i<4; i++)
  tmp[i] = array[i];

array = tmp; 
```





- 주의

```c
int * array = (int *)malloc(4*sizeof(int));
int array[4];
```

> 위 두 식은 얼핏보면 같아보이지만 큰 차이가 있다.

```c
int array[4];

...

array = tmp; // 불가능!!!
```

> '배열의 이름은 배열의 시작주소를 저장하는 포인터 변수. **(단 그 값을 변경할 수 없음)**'
>
> 에 의해 위 치환문이 불가능함
